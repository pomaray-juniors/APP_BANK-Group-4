CREATE DATABASE APP_BANCO;
GO

USE APP_BANCO;
GO

CREATE TABLE CLIENTE (
    CEDULA INT PRIMARY KEY NOT NULL,
    NOMBRE VARCHAR(20) NOT NULL,
    APELLIDO VARCHAR(20) NOT NULL,
    EMAIL VARCHAR(100),
    TELEFONO VARCHAR(50)
);


Alter table Cliente ADD Direccion varchar(100);
Select * from Cliente




CREATE TABLE PERSONAL (
    CEDULA_PERSONAL INT PRIMARY KEY NOT NULL,
    NOMBRE VARCHAR(20) NOT NULL,
    APELLIDO VARCHAR(20) NOT NULL,
    FECHA_NACIMIENTO_PERSONAL DATE,
    ROL VARCHAR(50),
    FECHA_INGRESO DATE
);



CREATE TABLE CUENTA (
    NUMERO_CUENTA INT PRIMARY KEY,
    TIPO_CUENTA VARCHAR(50),
    MONTO DECIMAL(10,2) CHECK (MONTO >= 0),
    FECHA_APERTURA DATE,
    CEDULA INT,
    FOREIGN KEY (CEDULA) REFERENCES CLIENTE (CEDULA)
);

CREATE TABLE TRANSACCIONES (
    ID INT IDENTITY(1,1) PRIMARY KEY,
    MONTO DECIMAL(10,2) CHECK (MONTO >= 0),
    TIPO_TRANSACCION VARCHAR(50),
    DESCRIPCION VARCHAR(100),
    NUMERO_CUENTA INT,
    NUMERO_CUENTA_DESTINO INT NULL,
    FOREIGN KEY (NUMERO_CUENTA) REFERENCES CUENTA (NUMERO_CUENTA),
    FOREIGN KEY (NUMERO_CUENTA_DESTINO) REFERENCES CUENTA (NUMERO_CUENTA),
    CONSTRAINT CUENTA_DISTINTAS CHECK (NUMERO_CUENTA <> NUMERO_CUENTA_DESTINO)
);

CREATE TABLE RECLAMOS (
    ID INT IDENTITY(1,1) PRIMARY KEY,
    DESCRIPCION VARCHAR(100),
    FECHA DATETIME DEFAULT GETDATE(),
    ESTADO VARCHAR(10) DEFAULT 'PENDIENTE' CHECK (ESTADO IN ('PENDIENTE', 'COMPLETADO')),
    FECHA_RESOLUCION DATE NULL,
    CEDULA INT,
    FOREIGN KEY (CEDULA) REFERENCES CLIENTE (CEDULA)
);

CREATE TABLE APERTURA_CUENTA (
    ID INT IDENTITY(1,1) PRIMARY KEY,
    TIPO_CUENTA VARCHAR(20),
    FECHA_APERTURA DATETIME DEFAULT GETDATE(),
    CEDULA_PERSONAL INT,
    CEDULA INT,
    FOREIGN KEY (CEDULA_PERSONAL) REFERENCES PERSONAL (CEDULA_PERSONAL),
    FOREIGN KEY (CEDULA) REFERENCES CLIENTE (CEDULA)
);

ALTER TABLE PERSONAL
ADD CONTRASEÑA VARCHAR(100) NOT NULL DEFAULT '1234'; -- Cambia esto en producción!
SELECT * FROM PERSONAL

UPDATE PERSONAL SET CONTRASEÑA = '1234' WHERE CEDULA_PERSONAL IN (111222333, 444555666);

INSERT INTO CLIENTE (CEDULA, NOMBRE, APELLIDO, EMAIL, TELEFONO) VALUES
(123456789, 'Juan', 'Pérez', '1985-06-15', 'juan.perez@example.com', '555-1234'),
(987654321, 'María', 'Gómez', '1990-08-22', 'maria.gomez@example.com', '555-5678');

-- Insertar datos en la tabla PERSONAL
INSERT INTO PERSONAL (CEDULA_PERSONAL, NOMBRE, APELLIDO, FECHA_NACIMIENTO_PERSONAL, ROL, FECHA_INGRESO) VALUES
(111222333, 'Carlos', 'López', '1975-03-10', 'Gerente', '2010-01-15'),
(444555666, 'Ana', 'Martínez', '1980-11-05', 'Cajero', '2015-06-01');

-- Insertar datos en la tabla CUENTA
INSERT INTO CUENTA (NUMERO_CUENTA, TIPO_CUENTA, MONTO, FECHA_APERTURA, CEDULA) VALUES
(1001, 'Ahorros', 1500.00, '2020-01-01', 123456789),
(1002, 'Corriente', 2500.00, '2021-05-15', 987654321);

-- Insertar datos en la tabla TRANSACCIONES
INSERT INTO TRANSACCIONES (MONTO, TIPO_TRANSACCION, DESCRIPCION, NUMERO_CUENTA, NUMERO_CUENTA_DESTINO) VALUES
(200.00, 'Depósito', 'Depósito en efectivo', 1001, NULL),
(150.00, 'Transferencia', 'Transferencia a cuenta 1002', 1001, 1002);

-- Insertar datos en la tabla RECLAMOS
INSERT INTO RECLAMOS (DESCRIPCION, ESTADO, CEDULA) VALUES
('Error en el estado de cuenta', 'PENDIENTE', 123456789),
('Problema con la tarjeta de débito', 'COMPLETADO', 987654321);

-- Insertar datos en la tabla APERTURA_CUENTA
INSERT INTO APERTURA_CUENTA (TIPO_CUENTA, CEDULA_PERSONAL, CEDULA) VALUES
('Ahorros', 111222333, 123456789),
('Corriente', 444555666, 987654321);
